<html>

<head>
    <title>BillPay</title>
</head>

@model List<BillPayViewModel>

<body>
    <h1>BillPay</h1>
    <table>
        <a asp-action="Add">Add</a>
        <tr>
            <th>Account Number</th>
            <th>Payee</th>
            <th>Amount</th>
            <th>Next Payment Schedule</th>
            <th>Period</th>
            <th>Action</th>
        </tr>
        @foreach (var billPayViewModel in Model)
        {
            var localDT = DateTime.Now;
            localDT = new DateTime(localDT.Year, localDT.Month, localDT.Day, localDT.Hour, localDT.Minute, 0);
            var isOverdue = billPayViewModel.ScheduleTimeLocal < localDT;
            var scheduleTimeLocalStr = billPayViewModel.ScheduleTimeLocal.ToString("dd/MM/yyyy hh:mm tt").ToUpper();
            <tr>
                <td>@billPayViewModel.AccountNumber</td>
                <td>@billPayViewModel.PayeeName</td>
                <td>@billPayViewModel.Amount</td>
                @{
                    if (isOverdue)
                    {
                        <td>@scheduleTimeLocalStr (Overdue)</td>
                    }
                    else
                    {
                        <td>@scheduleTimeLocalStr</td>
                    }
                }
                <td>@billPayViewModel.Period</td>
                <td>
                    <a asp-action="Cancel" asp-route-id="@billPayViewModel.BillPayID">
                        @{
                            if (isOverdue)
                            {
                                <span>Pay</span>
                            }
                            else
                            {
                                <span>Cancel</span>
                            }
                        }
                    </a>
                </td>
            </tr>
        }
        <tr></tr>
    </table>
</body>

</html>